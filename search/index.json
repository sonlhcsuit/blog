[{"content":"Khi xử lý với Event thông qua DOM ở trong Javascript, cần phải hiểu một chút kỹ càng về cách các event hoạt động. Mỗi khi một event được trigger, bắt đầu thực thi listener thì cùng lúc cũng có nhiều listener được kích hoạt cùng lúc. Có các cơ chế để trình duyệt thực hiện những listener theo một thứ tự xác định. Các cơ chế cơ bản đó là bubble \u0026amp; capturing.\nXem xét các ví dụ sau đây về độ sâu (depth) của cây DOM thông qua đoạn HTML\n\u0026lt;div class=\u0026#34;box box-1\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;box box-2\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;box box-3\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; *{ margin: 0; padding: 0; box-sizing: border-box; } .box { display: block; margin:20px; } .box.box-1{ width: 40vh; height: 40vh; border: solid 1px red; } .box.box-2{ width: 30vh; height: 30vh; border: solid 1px black; } .box.box-3{ width: 20vh; height: 20vh; border: solid 1px blue; } Khi hiển thị trên trình duyệt thì kết quả sẽ gồm 3 hình vuông lớn nhỏ theo kích thước và thứ tự sau:  Hiển thị đoạn của code ở phía trên \nBox 3 - nằm trong Box 2 - nằm trong Box 1. Sử dụng một chút logic thì ta cũng có thể nhận thấy rằng khi người dùng click vào Box 3 thì cũng là người dùng click vào Box 2 và Box 1 (bởi vì Box 2 và Box 1 có kích thước lớn hơn và Box 3 nằm ở bên trong)\nNếu chúng ta thêm các listener vào event click, thì khi event được trigger ở Box 3 thì các listener ở Box 2, Box 1 cũng được trigger theo. Và kết quả là cả 3 listener đều được thực thi. Điều này đúng với logic căn bản, tuy nhiên nếu các listener này xung đột lẫn nhau (ví dụ ẩn/hiện các component thì không hợp lý chút nào ). Cần nắm rõ cơ chế lan truyền - propagation - các event.\nCó 2 cơ chế lan truyền chính của các trình duyệt hiện tại là bubble \u0026amp; capture. Nhiều trình duyệt đã chuyển sang cơ chế mặc định là bubbles - từ \u0026ldquo;dưới lên \u0026ldquo;trên\u0026rdquo;. Còn cơ chế capture sẽ ngược lại, từ \u0026ldquo;trên\u0026rdquo; xuống \u0026ldquo;dưới\u0026rdquo;.\nĐối với cơ chế capture: trình duyệt sẽ bắt đầu từ gốc của cây DOM, tìm dần xuống tới element được kích hoạt (Box 3). Để tới được Box 3 thì phải trải qua các Node sau : html -\u0026gt; body -\u0026gt; box 1 -\u0026gt; box 2 -\u0026gt; box 3. Như vậy theo cách duyệt cây này thì các listener sẽ được trigger theo thứ tự trên (nếu đã được định nghĩa). Còn cơ chế bubble sẽ thực hiện ngược lại, từ node lá duyệt ngược lên gốc: box 3 -\u0026gt; box 2 -\u0026gt; box 1 -\u0026gt; body -\u0026gt; html. Và các listener sẽ được kích hoạt với thứ tự trên.\nMặc định các trình duyệt hiện đại đều sử dụng cơ chế bubble. Tuy nhiên ta có thể chỉ định sử dụng cơ chết capture bằng cách sau.\ndocument.querySelectorAll(\u0026#39;.box\u0026#39;).forEach(element =\u0026gt; { element.addEventListener(\u0026#34;click\u0026#34;, function (){ console.log(this.classList.value) }) }) // bubbles  Cơ chế bubble \ndocument.querySelectorAll(\u0026#39;.box\u0026#39;).forEach(element =\u0026gt; { element.addEventListener(\u0026#34;click\u0026#34;, function() { console.log(this.classList.value) }, { capture: true }) }) // capture  Cơ chế capture \nTuy nhiên đôi khi chúng ta cần ngăn chặn sự lan truyền (tức là chỉ kích hoạt những listener phía trước để đảm bảo đúng dữ kiện ) bằng cách sử dụng phương thức Event.stopPropagation()\ndocument.querySelectorAll(\u0026#39;.box\u0026#39;).forEach(element =\u0026gt; { element.addEventListener(\u0026#34;click\u0026#34;, function(event) { console.log(this.classList.value) event.stopPropagation() }, { // capture:true  } ) })  Cơ chế bubble với stopPropagation   Cơ chế capture với stopPropagation \nWednesday 31/03/2021\n","date":"2021-03-31T11:14:24+07:00","permalink":"https://sonlhcsuit.github.io/p/event-bubbles/","title":"Event Bubbling \u0026 Capturing"},{"content":"Hôm nay cũng như bao hôm khác, sẽ là một ngày chủ nhật thật đẹp với bầu trời xanh của thành phố quen thuộc.\nMới vừa bước ra công ty sau một ngày chủ nhật mệt mỏi, lái trên đường về dọc kênh Nhiêu Lộc - Thị Nghè. Đang trên đường mà cứ thả hồn vào trời mây, việc lái xe thì nhường lại cho tay chân với phản xạ cơ bản.\nKhông hiểu vì lí do gì mà cảm xúc trống rỗng, buồn,\u0026hellip; lấp đầy tâm trí. Không biết buồn vì điều chi, chỉ cảm thấy thiếu 1 thứ gì đó rất quan trọng.\nCàng lớn, cảm xúc tích cực càng ít đi, thay vào đó là những khoảng lặng.\nSực nhớ ra hôm nay là valentine trắng, dường như chính cảm xúc mình lại chết một ít.\nSunday 14/03/21\n","date":"2021-03-15T01:17:31+07:00","image":"https://sonlhcsuit.github.io/p/valentine-trang/Nhieu_Loc_Thi_Nghe_hu7a3348dd1f670f38516753d703135e0a_1056819_120x120_fill_q75_box_smart1.jpg","permalink":"https://sonlhcsuit.github.io/p/valentine-trang/","title":"Valentine Trang"}]